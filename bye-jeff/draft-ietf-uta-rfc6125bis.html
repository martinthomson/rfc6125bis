<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Service Names in TLS</title>
<meta content="Peter Saint-Andre" name="author">
<meta content="Rich Salz" name="author">
<meta content="
       Many application technologies enable secure communication between two entities
by means of Transport Layer Security (TLS) with
Internet Public Key Infrastructure Using X.509 (PKIX) certificates.
This document specifies
procedures for representing and verifying the identity of application services
in such interactions. 
       This document obsoletes RFC 6125. 
    " name="description">
<meta content="xml2rfc 3.12.7" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-uta-rfc6125bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.7
    Python 3.9.7
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.5
    MarkupSafe 2.0.1
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 52.0.0
    six 1.16.0
-->
<link href="draft-ietf-uta-rfc6125bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow, svg + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
/* Trick: a prefix match works because only black and white are allowed */
svg [stroke="black"], svg [stroke^="#000"] {
  stroke: var(--text-color);
}
svg [stroke="white"], svg [stroke^="#fff"] {
  stroke: var(--background-color);
}
svg [fill="black"], svg [fill^="#000"], svg :not([fill]) {
  fill: var(--text-color);
}
svg [stroke="fill"], svg [fill^="#fff"] {
  fill: var(--background-color);
}
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Service Identity</td>
<td class="right">May 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Saint-Andre &amp; Salz</td>
<td class="center">Expires 29 November 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-uta-rfc6125bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6125" class="eref">6125</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-05-28" class="published">28 May 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-11-29">29 November 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Saint-Andre</div>
</div>
<div class="author">
      <div class="author-name">R. Salz</div>
<div class="org">Akamai Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Service Names in TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Many application technologies enable secure communication between two entities
by means of Transport Layer Security (TLS) with
Internet Public Key Infrastructure Using X.509 (PKIX) certificates.
This document specifies
procedures for representing and verifying the identity of application services
in such interactions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document obsoletes RFC 6125.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Using TLS in Applications Working Group mailing list (uta@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/uta/">https://mailarchive.ietf.org/arch/browse/uta/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/richsalz/draft-ietf-uta-rfc6125bis">https://github.com/richsalz/draft-ietf-uta-rfc6125bis</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 November 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-motivation" class="xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-applicability" class="xref">Applicability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-overview-of-recommendations" class="xref">Overview of Recommendations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-scope" class="xref">Scope</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="xref">1.4.1</a>.  <a href="#name-in-scope" class="xref">In Scope</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a href="#section-1.4.2" class="xref">1.4.2</a>.  <a href="#name-out-of-scope" class="xref">Out of Scope</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-naming-of-application-servi" class="xref">Naming of Application Services</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-designing-application-proto" class="xref">Designing Application Protocols</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-representing-server-identit" class="xref">Representing Server Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-rules" class="xref">Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-examples" class="xref">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-requesting-server-certifica" class="xref">Requesting Server Certificates</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-verifying-service-identity" class="xref">Verifying Service Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-constructing-a-list-of-refe" class="xref">Constructing a List of Reference Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-rules-2" class="xref">Rules</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-examples-2" class="xref">Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-preparing-to-seek-a-match" class="xref">Preparing to Seek a Match</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-matching-the-dns-domain-nam" class="xref">Matching the DNS Domain Name Portion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-matching-the-application-se" class="xref">Matching the Application Service Type Portion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-outcome" class="xref">Outcome</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-wildcard-certificates" class="xref">Wildcard Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-internationalized-domain-na" class="xref">Internationalized Domain Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-multiple-presented-identifi" class="xref">Multiple Presented Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-multiple-reference-identifi" class="xref">Multiple Reference Identifiers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-changes-from-rfc-6125" class="xref">Changes from RFC 6125</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">The visible face of the Internet largely consists of services that employ a
client-server architecture in which a client
communicates with an application service.  When a client communicates with an
application service using <span>[<a href="#TLS" class="xref">TLS</a>]</span>, <span>[<a href="#DTLS" class="xref">DTLS</a>]</span>, or a protocol built on those,
it has some notion of the server's
identity (e.g., "the website at example.com") while attempting to establish
secure communication.  Likewise, during TLS negotiation, the server presents
its notion of the service's identity in the form of a public-key certificate
that was issued by a certificate authority (CA) in the context of the
Internet Public Key Infrastructure using X.509 <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.  Informally, we can
think of these identities as the client's "reference identity" and the
server's "presented identity"; more formal definitions are given later.  A
client needs to verify that the server's presented identity matches its
reference identity so it can deterministically and automatically authenticate the communication.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document defines procedures for how clients do this verification.
It therefore also defines requirements on other parties, such as
the certificate authorities that issue certificates, the service administrators requesting
them, and the protocol designers defining how things are named.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document obsoletes RFC 6125. Changes from RFC 6125 are described under <a href="#changes" class="xref">Appendix A</a>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="applicability">
<section id="section-1.2">
        <h3 id="name-applicability">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-applicability" class="section-name selfRef">Applicability</a>
        </h3>
<p id="section-1.2-1">This document does not supersede the rules for certificate issuance or
validation specified by <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.  That document also governs any
certificate-related topic on which this document is silent.  This includes
certificate syntax, extensions such as name constraints or
extended key usage, and handling of certification paths.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">This document addresses only name forms in the leaf "end entity" server
certificate.  It does not address the name forms in the chain of certificates
used to validate a cetrificate, let alone creating or checking the validity
of such a chain.  In order to ensure proper authentication, applications need
to verify the entire certification path as per <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-1.3">
        <h3 id="name-overview-of-recommendations">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-overview-of-recommendations" class="section-name selfRef">Overview of Recommendations</a>
        </h3>
<p id="section-1.3-1">The previous version of this specification, <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span>, surveyed the then-current
practice from many IETF standards and tried to generalize best practices
(see Appendix A <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span> for details).
This document takes the lessons learned since then and codifies them.
The rules are brief:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Only check DNS domain names via the subjectAlternativeName
extension designed for that purpose: dNSName.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Allow use of even more specific
subjectAlternativeName extensions where appropriate such as
uniformResourceIdentifier and the otherName form SRVName.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Wildcard support is now the default.
Constrain wildcard certificates so that the wildcard can only
be the complete left-most component of a domain name.<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Do not include or check strings that look like domain names
in the subject's Common Name.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="scope">
<section id="section-1.4">
        <h3 id="name-scope">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<div id="in-scope">
<section id="section-1.4.1">
          <h4 id="name-in-scope">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-in-scope" class="section-name selfRef">In Scope</a>
          </h4>
<p id="section-1.4.1-1">This document applies only to service identities that meet these
three characteristics: associated with fully-qualified domain names (FQDNs),
used with TLS and DTLS, and are PKIX-based.<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-1.4.1-2">TLS uses the words client and server, where the client is the entity
that initiates the connection.  In many cases, this is consistent with common practice,
such as a browser connecting to a Web origin.
For the sake of clarity, and to follow the usage in <span>[<a href="#TLS" class="xref">TLS</a>]</span> and related
specifications, we will continue
to use the terms client and server in this document.
However, these are TLS-layer roles, and the application protocol
could support the TLS server making requests to the TLS client after the
TLS handshake; these is no requirement that the roles at the application
layer match the TLS layer.<a href="#section-1.4.1-2" class="pilcrow">¶</a></p>
<p id="section-1.4.1-3">At the time of this writing, other protocols such as <span>[<a href="#QUIC" class="xref">QUIC</a>]</span> and
Network Time Security (<span>[<a href="#NTS" class="xref">NTS</a>]</span>) use DTLS or TLS to do the
initial establishment of cryptographic key material.
The rules specified here apply to such services, as well.<a href="#section-1.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="out-of-scope">
<section id="section-1.4.2">
          <h4 id="name-out-of-scope">
<a href="#section-1.4.2" class="section-number selfRef">1.4.2. </a><a href="#name-out-of-scope" class="section-name selfRef">Out of Scope</a>
          </h4>
<p id="section-1.4.2-1">The following topics are out of scope for this specification:<a href="#section-1.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.1">Security protocols other than <span>[<a href="#TLS" class="xref">TLS</a>]</span> or <span>[<a href="#DTLS" class="xref">DTLS</a>]</span> except as
described above.<a href="#section-1.4.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.2">Keys or certificates employed outside the context of PKIX-based systems.<a href="#section-1.4.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.3">Client or end-user identities.
Certificates representing client identities other than as
described above, such as rfc822Name, are beyond the scope
of this document.<a href="#section-1.4.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.4">Identifiers other than FQDNs.
Identifiers such as IP address are not discussed. In addition, the focus of
this document is on application service identities, not specific resources
located at such services.  Therefore this document discusses Uniform
Resource Identifiers <span>[<a href="#URI" class="xref">URI</a>]</span> only as a way to communicate a DNS domain name
(via the URI "host" component or its equivalent), not other aspects of a
service such as a specific resource (via the URI "path" component) or
parameters (via the URI "query" component).<a href="#section-1.4.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.5">
              <p id="section-1.4.2-2.5.1">Certification authority policies.
This includes items such as the following:<a href="#section-1.4.2-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.5.2.1">How to certify or validate FQDNs and application
service types (see <span>[<a href="#ACME" class="xref">ACME</a>]</span> for some definition of this).<a href="#section-1.4.2-2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.4.2-2.5.2.2">Issuance of certificates with identifiers such as IP addresses
instead of or in addition to FQDNs.<a href="#section-1.4.2-2.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.4.2-2.5.2.3">Types or "classes" of certificates to issue and whether to apply different
policies for them.<a href="#section-1.4.2-2.5.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.4.2-2.5.2.4">How to certify or validate other kinds of information that might be
included in a certificate (e.g., organization name).<a href="#section-1.4.2-2.5.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.4.2-2.6">Resolution of DNS domain names.
Although the process whereby a client resolves the DNS domain name of an
application service can involve several steps, for our purposes we care
only about the fact that the client needs to verify the identity of the
entity with which it communicates as a result of the resolution process.
Thus the resolution process itself is out of scope for this specification.<a href="#section-1.4.2-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.7">User interface issues.
In general, such issues are properly the responsibility of client
software developers and standards development organizations
dedicated to particular application technologies (see, for example,
<span>[<a href="#WSC-UI" class="xref">WSC-UI</a>]</span>).<a href="#section-1.4.2-2.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-1.5">
        <h3 id="name-terminology">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.5-1">Because many concepts related to "identity" are often too vague to be
actionable in application protocols, we define a set of more concrete terms
for use in this specification.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.5-2">
          <dt id="section-1.5-2.1">application service:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.2">
            <p id="section-1.5-2.2.1">A service on the Internet that enables clients to connect for the
purpose of retrieving or uploading information, communicating with other
entities, or connecting to a broader network of services.<a href="#section-1.5-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.3">application service provider:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.4">
            <p id="section-1.5-2.4.1">An entity that hosts or deploys an application service.<a href="#section-1.5-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.5">application service type:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.6">
            <p id="section-1.5-2.6.1">A formal identifier for the application protocol used to provide a
particular kind of application service at a domain.  This often appears as
a URI scheme <span>[<a href="#URI" class="xref">URI</a>]</span>, DNS SRV Service <span>[<a href="#DNS-SRV" class="xref">DNS-SRV</a>]</span>, or an ALPN <span>[<a href="#ALPN" class="xref">ALPN</a>]</span>
identifier.<a href="#section-1.5-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.7">delegated domain:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.8">
            <p id="section-1.5-2.8.1">A domain name or host name that is explicitly configured for communicating
with the source domain, either by the human user controlling the client
or by a trusted administrator.  For example, a server at mail.example.net
could be a delegated domain for connecting to an IMAP server hosting an email address of
user@example.net.<a href="#section-1.5-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.9">derived domain:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.10">
            <p id="section-1.5-2.10.1">A domain name or host name that a client has derived from the source domain
in an automated fashion (e.g., by means of a <span>[<a href="#DNS-SRV" class="xref">DNS-SRV</a>]</span> lookup).<a href="#section-1.5-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.11">identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.12">
            <p id="section-1.5-2.12.1">A particular instance of an identifier type that is either presented by a
server in a certificate or referenced by a client for matching purposes.<a href="#section-1.5-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.13">identifier type:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.14">
            <p id="section-1.5-2.14.1">A formally-defined category of identifier that can be included in a
certificate and therefore that can also be used for matching purposes. For
conciseness and convenience, we define the following identifier types of
interest:<a href="#section-1.5-2.14.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.14.2.1">DNS-ID: a subjectAltName entry of type dNSName as defined in <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.<a href="#section-1.5-2.14.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.14.2.2">SRV-ID: a subjectAltName entry of type otherName whose name form is
SRVName, as defined in <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span>.<a href="#section-1.5-2.14.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.5-2.14.2.3">URI-ID: a subjectAltName entry of type uniformResourceIdentifier
as defined in <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>. This entry <span class="bcp14">MUST</span> include both a "scheme" and
a "host" component (or its equivalent) that matches the "reg-name"
rule (where the quoted terms represent the associated <span>[<a href="#ABNF" class="xref">ABNF</a>]</span>
productions from <span>[<a href="#URI" class="xref">URI</a>]</span>).  If the entry does not have both, it is not a
valid URI-ID and <span class="bcp14">MUST</span> be ignored.<a href="#section-1.5-2.14.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.15">PKIX:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.16">
            <p id="section-1.5-2.16.1">The short name for the Internet Public Key Infrastructure using X.509
defined in <span>[<a href="#PKIX" class="xref">PKIX</a>]</span>.  That document provides a profile of the X.509v3
certificate specifications and X.509v2 certificate revocation list (CRL)
specifications for use in the Internet.<a href="#section-1.5-2.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.17">presented identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.18">
            <p id="section-1.5-2.18.1">An identifier presented by a server to a client within a PKIX certificate
when the client attempts to establish secure communication with the server.
The certificate can include one or more presented identifiers of different
types, and if the server hosts more than one domain then the certificate
might present distinct identifiers for each domain.<a href="#section-1.5-2.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.19">reference identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.20">
            <p id="section-1.5-2.20.1">An identifier used by the client when examining presented identifiers.
It is constructed from the source domain, and optionally an application
service type.<a href="#section-1.5-2.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.21">Relative Distinguished Name (RDN):</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.22">
            <p id="section-1.5-2.22.1">An ASN.1-based construction which itself is a building-block component of
Distinguished Names. See <span>[<a href="#LDAP-DN" class="xref">LDAP-DN</a>], <a href="https://rfc-editor.org/rfc/rfc4514#section-2" class="relref">Section 2</a></span>.<a href="#section-1.5-2.22.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.23">source domain:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.24">
            <p id="section-1.5-2.24.1">The FQDN that a client expects an application
service to present in the certificate. This is typically input by
a human user, configured into a client, or provided by reference such as
a URL. The combination of a source domain and, optionally, an application
service type enables a client to construct one or more reference
identifiers.<a href="#section-1.5-2.24.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.25">subjectAltName entry:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.26">
            <p id="section-1.5-2.26.1">An identifier placed in a subjectAltName extension.<a href="#section-1.5-2.26.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.27">subjectAltName extension:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.28">
            <p id="section-1.5-2.28.1">A standard PKIX extension enabling identifiers of various types to be
bound to the certificate subject.<a href="#section-1.5-2.28.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.29">subjectName:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-2.30">
            <p id="section-1.5-2.30.1">The name of a PKIX certificate's subject, encoded in a certificate's
subject field (see <span>[<a href="#PKIX" class="xref">PKIX</a>], <a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.6" class="relref">Section 4.1.2.6</a></span>).<a href="#section-1.5-2.30.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.5-3">Security-related terms used in this document, but not defined here or in
<span>[<a href="#PKIX" class="xref">PKIX</a>]</span> should be understood in the the sense defined in <span>[<a href="#SECTERMS" class="xref">SECTERMS</a>]</span>. Such
terms include "attack", "authentication", "identity", "trust", "validate",
and "verify".<a href="#section-1.5-3" class="pilcrow">¶</a></p>
<p id="section-1.5-4">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="names">
<section id="section-2">
      <h2 id="name-naming-of-application-servi">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-naming-of-application-servi" class="section-name selfRef">Naming of Application Services</a>
      </h2>
<p id="section-2-1">This document assumes that the name of an application service is
based on a DNS domain name (e.g., <code>example.com</code>) -- supplemented in
some circumstances by an application service type (e.g., "the IMAP
server at example.net").
The DNS name conforms to one of the following forms:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-2">
<li id="section-2-2.1">A "traditional domain name", i.e., a FQDN (see <span>[<a href="#DNS-CONCEPTS" class="xref">DNS-CONCEPTS</a>]</span>) all of
  whose labels are "LDH labels" as described in <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span>.  Informally,
  such labels are constrained to <span>[<a href="#US-ASCII" class="xref">US-ASCII</a>]</span> letters, digits, and the
  hyphen, with the hyphen prohibited in the first character position.
  Additional qualifications apply (refer to the above-referenced
  specifications for details), but they are not relevant here.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.2">An "internationalized domain name", i.e., a DNS domain name that includes at
  least one label containing appropriately encoded Unicode code points
  outside the traditional US-ASCII range. That is, it contains at least one
  U-label or A-label, but otherwise may contain any mixture of NR-LDH labels,
  A-labels, or U-labels, as described in <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span> and the associated
  documents.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-2-3">From the perspective of the application client or user, some names are
<em>direct</em> because they are provided directly by a human user.  This includes
runtime input, prior configuration, or explicit acceptance of a client
communication attempt.  Other names are <em>indirect</em> because they are
automatically resolved by the application based on user input, such as a
target name resolved from a source name using DNS SRV or <span>[<a href="#NAPTR" class="xref">NAPTR</a>]</span> records.
The distinction matters most for certificate consumption, specifically
verification as discussed in this document.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">From the perspective of the application service, some names are
<em>unrestricted</em> because they can be used in any type of service, such as a
single certificate being used for both the HTTP and IMAP services at the host
example.com.  Other names are <em>restricted</em> because they can only be used for
one type of service, such as a special-purpose certificate that can only be
used for an IMAP service.  This distinction matters most for certificate
issuance.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">We can categorize the three identifier types as follows:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">A DNS-ID is direct and unrestricted.<a href="#section-2-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.2">An SRV-ID is typically indirect but can be direct, and is restricted.<a href="#section-2-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.3">A URI-ID is direct and restricted.<a href="#section-2-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-7">It is important to keep these distinctions in mind, because best practices
for the deployment and use of the identifiers differ.
Note that cross-protocol attacks such as <span>[<a href="#ALPACA" class="xref">ALPACA</a>]</span>
are possibile when two
different protocol services use the same certificate.
This can be addressed by using restricted identifiers, or deploying
services so that they do not share certificates.
Protocol specifications <span class="bcp14">MUST</span> specify which identifiers are
mandatory-to-implement and <span class="bcp14">SHOULD</span> provide operational guidance when necessary.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">The Common Name RDN <span class="bcp14">MUST NOT</span> be used to identify a service. Reasons
for this include:<a href="#section-2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-9.1">It is not strongly typed and therefore suffers from ambiguities
in interpretation.<a href="#section-2-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-9.2">It can appear more than once in the subjectName.<a href="#section-2-9.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-10">For similar reasons, other RDN's within the subjectName <span class="bcp14">MUST NOT</span> be used to
identify a service.<a href="#section-2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design">
<section id="section-3">
      <h2 id="name-designing-application-proto">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-designing-application-proto" class="section-name selfRef">Designing Application Protocols</a>
      </h2>
<p id="section-3-1">This section defines how protocol designers should reference this document,
which would typically be a normative reference in their specification.
Its specification
<span class="bcp14">MAY</span> choose to allow only one of the identifier types defined here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">If the technology does not use DNS SRV records to resolve the DNS domain
names of application services then its specification <span class="bcp14">MUST</span> state that SRV-ID
as defined in this document is not supported.  Note that many existing
application technologies use DNS SRV records to resolve the DNS domain names
of application services, but do not rely on representations of those records
in PKIX certificates by means of SRV-IDs as defined in <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">If the technology does not use URIs to identify application services, then
its specification <span class="bcp14">MUST</span> state that URI-ID as defined in this document is not
supported.  Note that many existing application technologies use URIs to
identify application services, but do not rely on representation of those
URIs in PKIX certificates by means of URI-IDs.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">A technology <span class="bcp14">MAY</span> disallow the use of the wildcard character in DNS names. If
it does so, then the specification <span class="bcp14">MUST</span> state that wildcard certificates as
defined in this document are not supported.<a href="#section-3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="represent">
<section id="section-4">
      <h2 id="name-representing-server-identit">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-representing-server-identit" class="section-name selfRef">Representing Server Identity</a>
      </h2>
<p id="section-4-1">This section provides instructions for issuers of
certificates.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="represent-rules">
<section id="section-4.1">
        <h3 id="name-rules">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-rules" class="section-name selfRef">Rules</a>
        </h3>
<p id="section-4.1-1">When a certificate authority issues a certificate based on the FQDN
at which the application service provider
will provide the relevant application, the following rules apply to
the representation of application service identities.
Note that some of these rules are cumulative
and can interact in important ways that are illustrated later in this
document.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-2">
<li id="section-4.1-2.1">The certificate <span class="bcp14">SHOULD</span> include a "DNS-ID" as a baseline
for interoperability.<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.2">If the service using the certificate deploys a technology for which
  the relevant specification stipulates that certificates ought to
  include identifiers of type SRV-ID (e.g., <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>),
  then the certificate <span class="bcp14">SHOULD</span> include an SRV-ID.<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.3">If the service using the certificate deploys a technology for which
  the relevant specification stipulates that certificates ought to include
  identifiers of type URI-ID (e.g., <span>[<a href="#SIP" class="xref">SIP</a>]</span> as specified by
  <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>), then the certificate <span class="bcp14">SHOULD</span> include a URI-ID.  The scheme
  <span class="bcp14">MUST</span> be that of the protocol associated with the application service type
  and the "host" component (or its equivalent) <span class="bcp14">MUST</span> be the FQDN
  of the service.  The application protocol specification
  <span class="bcp14">MUST</span> specify which URI schemes are acceptable in URI-IDs contained in PKIX
  certificates used for the application protocol (e.g., <code>sip</code> but not <code>sips</code>
  or <code>tel</code> for SIP as described in <span>[<a href="#SIP-SIPS" class="xref">SIP-SIPS</a>]</span>).<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.4">The certificate <span class="bcp14">MAY</span> contain more than one DNS-ID, SRV-ID, or URI-ID
  as further explained under <a href="#security-multi" class="xref">Section 7.3</a>.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.5">The certificate <span class="bcp14">MAY</span> include other application-specific identifiers
  for compatibility with a deployed base. Such identifiers are out of
  scope for this specification.<a href="#section-4.1-2.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="represent-examples">
<section id="section-4.2">
        <h3 id="name-examples">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-4.2-1">Consider a simple website at <code>www.example.com</code>, which is not discoverable via
DNS SRV lookups.  Because HTTP does not specify the use of URIs in server
certificates, a certificate for this service might include only a DNS-ID of
<code>www.example.com</code>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Consider an IMAP-accessible email server at the host <code>mail.example.net</code>
servicing email addresses of the form <code>user@example.net</code> and discoverable via
DNS SRV lookups on the application service name of <code>example.net</code>.  A
certificate for this service might include SRV-IDs of <code>_imap.example.net</code> and
<code>_imaps.example.net</code> (see <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>) along with DNS-IDs of <code>example.net</code>
and <code>mail.example.net</code>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Consider a SIP-accessible voice-over-IP (VoIP) server at the host
<code>voice.example.edu</code> servicing SIP addresses of the form
<code>user@voice.example.edu</code> and identified by a URI of &lt;sip:voice.example.edu&gt;.
A certificate for this service would include a URI-ID of
<code>sip:voice.example.edu</code> (see <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>) along with a DNS-ID of
<code>voice.example.edu</code>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Consider an XMPP-compatible instant messaging (IM) server at the host
<code>im.example.org</code> servicing IM addresses of the form <code>user@im.example.org</code> and
discoverable via DNS SRV lookups on the <code>im.example.org</code> domain.  A
certificate for this service might include SRV-IDs of
<code>_xmpp-client.im.example.org</code> and <code>_xmpp-server.im.example.org</code> (see
<span>[<a href="#XMPP" class="xref">XMPP</a>]</span>), a DNS-ID of <code>im.example.org</code>.  For backward compatibility, it may
also have an XMPP-specific <code>XmppAddr</code> of <code>im.example.org</code> (see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>).<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request">
<section id="section-5">
      <h2 id="name-requesting-server-certifica">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-requesting-server-certifica" class="section-name selfRef">Requesting Server Certificates</a>
      </h2>
<p id="section-5-1">This section provides instructions for service providers regarding
the information to include in certificate signing requests (CSRs).
In general, service providers <span class="bcp14">SHOULD</span> request certificates that
include all of the identifier types that are required or recommended for
the application service type that will be secured using the certificate to
be issued.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If the certificate will be used for only a single type of application
service, the service provider <span class="bcp14">SHOULD</span> request a certificate that includes
a DNS-ID and, if appropriate for the application service type, an SRV-ID or
URI-ID that limits the deployment scope of the certificate to only the
defined application service type.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">If the certificate might be used for any type of application service, then
the service provider <span class="bcp14">SHOULD</span> request a certificate that includes
only a DNS-ID. Again, because of multi-protocol attacks this practice is
discouraged; this can be mitigated by deploying only one service on
a host.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">If a service provider offers multiple application service types and wishes to
limit the applicability of certificates using SRV-IDs or URI-IDs, they <span class="bcp14">SHOULD</span>
request multiple certificates, rather than a single certificate containing
multiple SRV-IDs or URI-IDs each identifying a different application service
type. This rule does not apply to application service type "bundles" that
identify distinct access methods to the same underlying application such as
an email application with access methods denoted by the application service
types of <code>imap</code>, <code>imaps</code>, <code>pop3</code>, <code>pop3s</code>, and <code>submission</code> as described in
<span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>.<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-6">
      <h2 id="name-verifying-service-identity">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-verifying-service-identity" class="section-name selfRef">Verifying Service Identity</a>
      </h2>
<p id="section-6-1">At a high level, the client verifies the application service's
identity by performing the following actions:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6-2">
<li id="section-6-2.1">The client constructs a list of acceptable reference identifiers
  based on the source domain and, optionally, the type of service to
  which the client is connecting.<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-6-2.2">The server provides its identifiers in the form of a PKIX
certificate.<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-6-2.3">The client checks each of its reference identifiers against the
  presented identifiers for the purpose of finding a match. When checking a
  reference identifier against a presented identifier, the client matches the
  source domain of the identifiers and, optionally, their application service
  type.<a href="#section-6-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-6-3">Naturally, in addition to checking identifiers, a client should perform
further checks, such as expiration and revocation, to ensure that the server
is authorized to provide the requested service.  Because such checking is not a
matter of verifying the application service identity presented in a
certificate, methods for doing so are out of scope for
this document.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="verify-reference">
<section id="section-6.1">
        <h3 id="name-constructing-a-list-of-refe">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-constructing-a-list-of-refe" class="section-name selfRef">Constructing a List of Reference Identifiers</a>
        </h3>
<div id="verify-reference-rules">
<section id="section-6.1.1">
          <h4 id="name-rules-2">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-rules-2" class="section-name selfRef">Rules</a>
          </h4>
<p id="section-6.1.1-1">The client <span class="bcp14">MUST</span> construct a list of acceptable reference identifiers,
and <span class="bcp14">MUST</span> do so independently of the identifiers presented by the
service.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The inputs used by the client to construct its list of reference identifiers
might be a URI that a user has typed into an interface (e.g., an HTTPS URL
for a website), configured account information (e.g., the domain name of a
host for retrieving email, which might be different from the DNS domain name
portion of a username), a hyperlink in a web page that triggers a browser to
retrieve a media object or script, or some other combination of information
that can yield a source domain and an application service type.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">The client might need to extract the source domain and application service
type from the input(s) it has received.  The extracted data <span class="bcp14">MUST</span> include only
information that can be securely parsed out of the inputs, such as parsing
the FQDN out of the "host" component or deriving the application service type
from the scheme of a URI.  Other possibilities include pulling the data from
a delegated domain that is explicitly established via client or system
configuration or resolving the data via <span>[<a href="#DNSSEC" class="xref">DNSSEC</a>]</span>.
These considerations apply only to extraction of the source domain from the
inputs.  Naturally, if the inputs themselves are invalid or corrupt (e.g., a
user has clicked a link provided by a malicious entity in a phishing attack),
then the client might end up communicating with an unexpected application
service.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1.1-4">For example, given an input URI of &lt;sip:alice@example.net&gt;, a client
would derive the application service type <code>sip</code> from the scheme
and parse the domain name <code>example.net</code> from the host component.<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1.1-5">Each reference identifier in the list <span class="bcp14">MUST</span> be based on the source domain and
<span class="bcp14">MUST NOT</span> be based on a derived domain such as a domain name discovered
through DNS resolution of the source domain.  This rule is important because
only a match between the user inputs and a presented identifier enables the
client to be sure that the certificate can legitimately be used to secure the
client's communication with the server. This removes
DNS and DNS resolution from the attack surface.<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1.1-6">Using the combination of FQDN(s) and application service type, the client
<span class="bcp14">MUST</span> construct its list of reference identifiers in accordance with the
following rules:<a href="#section-6.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-7.1">The list <span class="bcp14">SHOULD</span> include a DNS-ID.
A reference identifier of type DNS-ID can be directly constructed from a
FQDN that is (a) contained in or securely derived from the inputs, or
(b) explicitly associated with the source domain by means of user
configuration.<a href="#section-6.1.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-7.2">If a server for the application service type is typically discovered
by means of DNS SRV records, then the list <span class="bcp14">SHOULD</span> include an SRV-ID.<a href="#section-6.1.1-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-7.3">If a server for the application service type is typically associated
with a URI for security purposes (i.e., a formal protocol document
specifies the use of URIs in server certificates), then the list
<span class="bcp14">SHOULD</span> include a URI-ID.<a href="#section-6.1.1-7.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.1-8">Which identifier types a client includes in its list of reference
identifiers, and their priority, is a matter of local policy.  For example, a
client that is built to connect only to a particular kind of service might be
configured to accept as valid only certificates that include an SRV-ID for
that application service type.  By contrast, a more lenient client, even if
built to connect only to a particular kind of service, might include both
SRV-IDs and DNS-IDs in its list of reference identifiers.<a href="#section-6.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-reference-examples">
<section id="section-6.1.2">
          <h4 id="name-examples-2">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-examples-2" class="section-name selfRef">Examples</a>
          </h4>
<p id="section-6.1.2-1">The following examples are for illustrative purposes only and are not
intended to be comprehensive.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1.2-2">
<li id="section-6.1.2-2.1">A web browser that is connecting via HTTPS to the website at <code>www.example.com</code>
would have a single reference identifier: a DNS-ID of <code>www.example.com</code>.<a href="#section-6.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.2-2.2">A mail user agent that is connecting via IMAPS to the email service at
<code>example.net</code> (resolved as <code>mail.example.net</code>) might have three reference
identifiers: an SRV-ID of <code>_imaps.example.net</code> (see <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>), and
DNS-IDs of <code>example.net</code> and <code>mail.example.net</code>.  An email user agent that
does not support <span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span> would probably be explicitly configured to
connect to <code>mail.example.net</code>, whereas an SRV-aware user agent would derive
<code>example.net</code> from an email address of the form <code>user@example.net</code> but might
also accept <code>mail.example.net</code> as the DNS domain name portion of reference
identifiers for the service.<a href="#section-6.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.2-2.3">A voice-over-IP (VoIP) user agent that is connecting via SIP to the voice
service at <code>voice.example.edu</code> might have only one reference identifier:
a URI-ID of <code>sip:voice.example.edu</code> (see <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>).<a href="#section-6.1.2-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.2-2.4">An instant messaging (IM) client that is connecting via XMPP to the IM
service at <code>im.example.org</code> might have three reference identifiers: an
SRV-ID of <code>_xmpp-client.im.example.org</code> (see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>), a DNS-ID of
<code>im.example.org</code>, and an XMPP-specific <code>XmppAddr</code> of <code>im.example.org</code>
(see <span>[<a href="#XMPP" class="xref">XMPP</a>]</span>).<a href="#section-6.1.2-2.4" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.1.2-3">In all of these cases, presented identifiers that do not match the reference
identifier(s) would be rejected; for instance:<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-4.1">With regard to the first example a DNS-ID of "web.example.com" would
be rejected because the DNS domain name portion does not match
"www.example.com".<a href="#section-6.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.2-4.2">With regard to the third example, a URI-ID of "sip:www.example.edu"
would be rejected because the DNS domain name portion does not match
"voice.example.edu" and a DNS-ID of "voice.example.edu" would be
rejected because it lacks the appropriate application service type
portion (i.e., it does not specify a "sip:" URI).<a href="#section-6.1.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="verify-seek">
<section id="section-6.2">
        <h3 id="name-preparing-to-seek-a-match">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-preparing-to-seek-a-match" class="section-name selfRef">Preparing to Seek a Match</a>
        </h3>
<p id="section-6.2-1">Once the client has constructed its list of reference identifiers and has
received the server's presented identifiers,
the client checks its reference identifiers against the presented identifiers
for the purpose of finding a match.
The search fails if the client exhausts
its list of reference identifiers without finding a match.  The search succeeds
if any presented identifier matches one of the reference identifiers, at
which point the client <span class="bcp14">SHOULD</span> stop the search.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Before applying the comparison rules provided in the following
sections, the client might need to split the reference identifier into
its DNS domain name portion and its application service type portion,
as follows:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">A DNS-ID reference identifier <span class="bcp14">MUST</span> be used directly as the DNS domain
name and there is no application service type.<a href="#section-6.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">For an SRV-ID reference identifier, the DNS domain name portion is
the Name and the application service type portion is the Service.  For
example, an SRV-ID of <code>_imaps.example.net</code> has a DNS domain name portion
of <code>example.net</code> and an application service type portion of
<code>imaps</code>, which maps to the IMAP application protocol as explained in
<span>[<a href="#EMAIL-SRV" class="xref">EMAIL-SRV</a>]</span>.<a href="#section-6.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.3">For a reference identifier of type URI-ID, the DNS domain name
portion is the "reg-name" part of the "host" component and the application
service type portion is the scheme, as defined above.  Matching only the
"reg-name" rule from <span>[<a href="#URI" class="xref">URI</a>]</span> limits verification to DNS domain names,
thereby differentiating a URI-ID from a uniformResourceIdentifier entry
that contains an IP address or a mere host name, or that does not contain a
"host" component at all.  Furthermore, note that extraction of the
"reg-name" might necessitate normalization of the URI (as explained in
<span>[<a href="#URI" class="xref">URI</a>]</span>).  For example, a URI-ID of <code>sip:voice.example.edu</code> would be split
into a DNS domain name portion of <code>voice.example.edu</code> and an application
service type of <code>sip</code> (associated with an application protocol of SIP as
explained in <span>[<a href="#SIP-CERTS" class="xref">SIP-CERTS</a>]</span>).<a href="#section-6.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-4">A client <span class="bcp14">MUST</span> match the DNS name, and if an application service type
is present it <span class="bcp14">MUST</span> also match the service type as well.
These are described below.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-domain">
<section id="section-6.3">
        <h3 id="name-matching-the-dns-domain-nam">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-matching-the-dns-domain-nam" class="section-name selfRef">Matching the DNS Domain Name Portion</a>
        </h3>
<p id="section-6.3-1">This section describes how the client must determine if the presented DNS
name matches the reference DNS name.  The rules differ depending on whether
the domain to be checked is a traditional domain name or an
internationalized domain name, as defined in <a href="#names" class="xref">Section 2</a>.  For clients
that support names containing the wildcard character "*", this section
also specifies a supplemental rule for such "wildcard certificates".
This section uses the description of labels and domain names in
<span>[<a href="#DNS-CONCEPTS" class="xref">DNS-CONCEPTS</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">If the DNS domain name portion of a reference identifier is a traditional
domain name, then matching of the reference identifier against the presented
identifier <span class="bcp14">MUST</span> be performed by comparing the set of domain name labels using
a case-insensitive ASCII comparison, as clarified by <span>[<a href="#DNS-CASE" class="xref">DNS-CASE</a>]</span>.  For
example, <code>WWW.Example.Com</code> would be lower-cased to <code>www.example.com</code> for
comparison purposes.  Each label <span class="bcp14">MUST</span> match in order for the names to be
considered to match, except as supplemented by the rule about checking of
wildcard labels given below.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">If the DNS domain name portion of a reference identifier is an
internationalized domain name, then the client <span class="bcp14">MUST</span> convert any U-labels
<span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>]</span> in the domain name to A-labels before checking the domain name.
In accordance with <span>[<a href="#IDNA-PROTO" class="xref">IDNA-PROTO</a>]</span>, A-labels <span class="bcp14">MUST</span> be compared as
case-insensitive ASCII.  Each label <span class="bcp14">MUST</span> match in order for the domain names
to be considered to match, except as supplemented by the rule about checking
of wildcard labels given below.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">If the technology specification supports wildcards, then the client <span class="bcp14">MUST</span>
match the reference identifier against a presented identifier whose DNS
domain name portion contains the wildcard character "*" in a label provided
these requirements are met:<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-5">
<li id="section-6.3-5.1">There is only one wildcard character.<a href="#section-6.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.2">The wildcard character appears only as the complete content of the left-most label.<a href="#section-6.3-5.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.3-6">If the requirements are not met, the presented identifier is invalid and <span class="bcp14">MUST</span>
be ignored.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3-7">A wildcard in a presented identifier can only match exactly one label in a
reference identifier. Note that this is not the same as DNS wildcard
matching, where the "*" label always matches at least one whole label and
sometimes more. See <span>[<a href="#DNS-CONCEPTS" class="xref">DNS-CONCEPTS</a>], <a href="https://rfc-editor.org/rfc/rfc1034#section-4.3.3" class="relref">Section 4.3.3</a></span> and <span>[<a href="#DNS-WILDCARDS" class="xref">DNS-WILDCARDS</a>]</span>.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8">For information regarding the security characteristics of wildcard
certificates, see <a href="#security-wildcards" class="xref">Section 7.1</a>.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-app">
<section id="section-6.4">
        <h3 id="name-matching-the-application-se">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-matching-the-application-se" class="section-name selfRef">Matching the Application Service Type Portion</a>
        </h3>
<p id="section-6.4-1">The rules for matching the application service type depend on whether
the identifier is an SRV-ID or a URI-ID.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">These identifiers provide an application service type portion to be checked,
but that portion is combined only with the DNS domain name portion of the
SRV-ID or URI-ID itself.  For example, if a client's list of reference
identifiers includes an SRV-ID of <code>_xmpp-client.im.example.org</code> and a DNS-ID
of <code>apps.example.net</code>, the client <span class="bcp14">MUST</span> check both the combination of an
application service type of <code>xmpp-client</code> and a DNS domain name of
<code>im.example.org</code> and a DNS domain name of <code>apps.example.net</code>.  However, the
client <span class="bcp14">MUST NOT</span> check the combination of an application service type of
<code>xmpp-client</code> and a DNS domain name of <code>apps.example.net</code> because it does not
have an SRV-ID of <code>_xmpp-client.apps.example.net</code> in its list of reference
identifiers.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">If the identifier is an SRV-ID, then the application service name <span class="bcp14">MUST</span>
be matched in a case-insensitive manner, in accordance with <span>[<a href="#DNS-SRV" class="xref">DNS-SRV</a>]</span>.
Note that the <code>_</code> character is prepended to the service identifier in
DNS SRV records and in SRV-IDs (per <span>[<a href="#SRVNAME" class="xref">SRVNAME</a>]</span>), and thus does not
need to be included in any comparison.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">If the identifier is a URI-ID, then the scheme name portion <span class="bcp14">MUST</span> be
matched in a case-insensitive manner, in accordance with <span>[<a href="#URI" class="xref">URI</a>]</span>.
Note that the <code>:</code> character is a separator between the scheme name
and the rest of the URI, and thus does not need to be included in any
comparison.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="outcome">
<section id="section-6.5">
        <h3 id="name-outcome">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-outcome" class="section-name selfRef">Outcome</a>
        </h3>
<p id="section-6.5-1">If the client has found a presented identifier that matches a reference
identifier, then the service identity check has succeeded.  In this case, the
client <span class="bcp14">MUST</span> use the matched reference identifier as the validated identity of
the application service.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">If the client does not find a presented identifier matching any of the
reference identifiers, then the client <span class="bcp14">MUST</span> proceed as described as follows.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">If the client is an automated application,
then it <span class="bcp14">SHOULD</span> terminate the communication attempt with a bad
certificate error and log the error appropriately.  The application <span class="bcp14">MAY</span>
provide a configuration setting to disable this behavior, but it <span class="bcp14">MUST</span> enable
it by default.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<p id="section-6.5-4">If the client is one that is directly controlled by a human
user, then it <span class="bcp14">SHOULD</span> inform the user of the identity mismatch and
automatically terminate the communication attempt with a bad certificate
error in order to prevent users from inadvertently bypassing security
protections in hostile situations.
Such clients <span class="bcp14">MAY</span> give advanced users the option of proceeding
with acceptance despite the identity mismatch.  Although this behavior can be
appropriate in certain specialized circumstances, it needs to be handled with
extreme caution, for example by first encouraging even an advanced user to
terminate the communication attempt and, if they choose to proceed anyway, by
forcing the user to view the entire certification path before proceeding.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<p id="section-6.5-5">The application <span class="bcp14">MAY</span> also present the user with the ability to accept the
presented certificate as valid for subsequent connections.  Such ad-hoc
"pinning" <span class="bcp14">SHOULD NOT</span> restrict future connections to just the pinned
certificate. Local policy that statically enforces a given certificate for a
given peer <span class="bcp14">SHOULD</span> made available only as prior configuration, rather than a
just-in-time override for a failed connection.<a href="#section-6.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="security-wildcards">
<section id="section-7.1">
        <h3 id="name-wildcard-certificates">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-wildcard-certificates" class="section-name selfRef">Wildcard Certificates</a>
        </h3>
<p id="section-7.1-1">Wildcard certificates automatically vouch for any single-label host names
within their domain, but not multiple levels of domains.  This can be
convenient for administrators but also poses the risk of vouching for rogue
or buggy hosts. See for example <span>[<a href="#Defeating-SSL" class="xref">Defeating-SSL</a>]</span> (beginning at slide 91) and
<span>[<a href="#HTTPSbytes" class="xref">HTTPSbytes</a>]</span> (slides 38-40).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Protection against a wildcard that identifies a public suffix
<span>[<a href="#Public-Suffix" class="xref">Public-Suffix</a>]</span>, such as <code>*.co.uk</code> or <code>*.com</code>, is beyond the scope of this
document.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-idn">
<section id="section-7.2">
        <h3 id="name-internationalized-domain-na">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-internationalized-domain-na" class="section-name selfRef">Internationalized Domain Names</a>
        </h3>
<p id="section-7.2-1">Allowing internationalized domain names can lead to visually similar
characters, also referred to as "confusables", being included within
certificates. For discussion, see for example <span>[<a href="#IDNA-DEFS" class="xref">IDNA-DEFS</a>], <a href="https://rfc-editor.org/rfc/rfc5890#section-4.4" class="relref">Section 4.4</a></span>
and <span>[<a href="#UTS-39" class="xref">UTS-39</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-multi">
<section id="section-7.3">
        <h3 id="name-multiple-presented-identifi">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-multiple-presented-identifi" class="section-name selfRef">Multiple Presented Identifiers</a>
        </h3>
<p id="section-7.3-1">A given application service might be addressed by multiple DNS domain names
for a variety of reasons, and a given deployment might service multiple
domains or protocols. TLS Extensions such as TLS Server Name Indication
(SNI), discussed in <span>[<a href="#TLS" class="xref">TLS</a>], <a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2.2" class="relref">Section 4.4.2.2</a></span>, and Application Layer Protocol
Negotiation (ALPN), discussed in <span>[<a href="#ALPN" class="xref">ALPN</a>]</span>, provide a way for the application
to indicate the desired identifier and protocol to the server, which it
can then use to select the most appropriate certificate.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">This specification allows multiple DNS-IDs, SRV-IDs, or URI-IDs in a
certificate.  As a result, an application service can use the same
certificate for multiple hostnames, such as when a client does not support
the TLS SNI extension, or for multiple protocols, such as SMTP and HTTP, on a
single hostname.  Note that the set of names in a certificate is the set of
names that could be affected by a compromise of any other server named in
the set: the strength of any server in the set of names is determined by the
weakest of those servers that offer the names.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The way to mitigate this risk is to limit the number of names that
any server can speak for, and to ensure that all servers in the set
have a strong minimum configuration as described in <span>[<a href="#RFC7525bis" class="xref">RFC7525bis</a>]</span>.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-reference-identifiers">
<section id="section-7.4">
        <h3 id="name-multiple-reference-identifi">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-multiple-reference-identifi" class="section-name selfRef">Multiple Reference Identifiers</a>
        </h3>
<p id="section-7.4-1">This specification describes how a client may construct multiple acceptable
reference identifiers, and may match any of those reference identifiers with
the set of presented identifiers. <span>[<a href="#PKIX" class="xref">PKIX</a>], <a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.10" class="relref">Section 4.2.1.10</a></span> describes a
mechanism to allow CA certificates to be constrained in the set of presented
identifiers that they may include within server certificates.  However, these
constraints only apply to the explicitly enumerated name forms. For example,
a CA that is only name constrained for DNS-IDs is not constrained for SRV-IDs
and URI-IDs, unless those name forms are also explicitly included within the
name constraints extension.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">A client that constructs multiple reference identifiers of different types,
such as both DNS-ID and SRV-IDs, as described in <a href="#verify-reference-rules" class="xref">Section 6.1.1</a>,
<span class="bcp14">SHOULD</span> take care to ensure that CAs issuing such certificates are
appropriately constrained. This <span class="bcp14">MAY</span> take the form of local policy through
agreement with the issuing CA, or <span class="bcp14">MAY</span> be enforced by the client requiring
that if one form of presented identifier is constrained, such as a dNSName
name constraint for DNS-IDs, then all other forms of acceptable reference
identities are also constrained, such as requiring a uniformResourceIndicator
name constraint for URI-IDs.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no actions for IANA.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="DNS-CONCEPTS">[DNS-CONCEPTS]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1034">https://www.rfc-editor.org/rfc/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-SRV">[DNS-SRV]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2782">https://www.rfc-editor.org/rfc/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-WILDCARDS">[DNS-WILDCARDS]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span>, <span class="refTitle">"The Role of Wildcards in the Domain Name System"</span>, <span class="seriesInfo">RFC 4592</span>, <span class="seriesInfo">DOI 10.17487/RFC4592</span>, <time datetime="2006-07" class="refDate">July 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4592">https://www.rfc-editor.org/rfc/rfc4592</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IDNA-DEFS">[IDNA-DEFS]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5890">https://www.rfc-editor.org/rfc/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IDNA-PROTO">[IDNA-PROTO]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names in Applications (IDNA): Protocol"</span>, <span class="seriesInfo">RFC 5891</span>, <span class="seriesInfo">DOI 10.17487/RFC5891</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5891">https://www.rfc-editor.org/rfc/rfc5891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LDAP-DN">[LDAP-DN]</dt>
        <dd>
<span class="refAuthor">Zeilenga, K., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"</span>, <span class="seriesInfo">RFC 4514</span>, <span class="seriesInfo">DOI 10.17487/RFC4514</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4514">https://www.rfc-editor.org/rfc/rfc4514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKIX">[PKIX]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525bis">[RFC7525bis]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-rfc7525bis-07</span>, <time datetime="2022-05-26" class="refDate">26 May 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-rfc7525bis-07">https://datatracker.ietf.org/doc/html/draft-ietf-uta-rfc7525bis-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRVNAME">[SRVNAME]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name"</span>, <span class="seriesInfo">RFC 4985</span>, <span class="seriesInfo">DOI 10.17487/RFC4985</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4985">https://www.rfc-editor.org/rfc/rfc4985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="URI">[URI]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ABNF">[ABNF]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ACME">[ACME]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8555">https://www.rfc-editor.org/rfc/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ALPACA">[ALPACA]</dt>
        <dd>
<span class="refAuthor">Brinkmann, M.</span>, <span class="refAuthor">Dresen, C.</span>, <span class="refAuthor">Merget, R.</span>, <span class="refAuthor">Poddebniak, D.</span>, <span class="refAuthor">Müller, J.</span>, <span class="refAuthor">Somorovsky, J.</span>, <span class="refAuthor">Schwenk, J.</span>, and <span class="refAuthor">S. Schinzel</span>, <span class="refTitle">"ALPACA: Application Layer Protocol Confusion - Analyzing and Mitigating Cracks in TLS Authentication"</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://alpaca-attack.com/ALPACA.pdf">https://alpaca-attack.com/ALPACA.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ALPN">[ALPN]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7301">https://www.rfc-editor.org/rfc/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Defeating-SSL">[Defeating-SSL]</dt>
        <dd>
<span class="refAuthor">Marlinspike, M.</span>, <span class="refTitle">"New Tricks for Defeating SSL in Practice"</span>, <span class="seriesInfo">BlackHat DC</span>, <time datetime="2009-02" class="refDate">February 2009</time>, <span>&lt;<a href="http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf">http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-CASE">[DNS-CASE]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) Case Insensitivity Clarification"</span>, <span class="seriesInfo">RFC 4343</span>, <span class="seriesInfo">DOI 10.17487/RFC4343</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4343">https://www.rfc-editor.org/rfc/rfc4343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNSSEC">[DNSSEC]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4033">https://www.rfc-editor.org/rfc/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DTLS">[DTLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EMAIL-SRV">[EMAIL-SRV]</dt>
        <dd>
<span class="refAuthor">Daboo, C.</span>, <span class="refTitle">"Use of SRV Records for Locating Email Submission/Access Services"</span>, <span class="seriesInfo">RFC 6186</span>, <span class="seriesInfo">DOI 10.17487/RFC6186</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6186">https://www.rfc-editor.org/rfc/rfc6186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTPSbytes">[HTTPSbytes]</dt>
        <dd>
<span class="refAuthor">Sokol, J.</span> and <span class="refAuthor">R. Hansen</span>, <span class="refTitle">"HTTPS Can Byte Me"</span>, <span class="seriesInfo">BlackHat Abu Dhabi</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf">https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NAPTR">[NAPTR]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database"</span>, <span class="seriesInfo">RFC 3403</span>, <span class="seriesInfo">DOI 10.17487/RFC3403</span>, <time datetime="2002-10" class="refDate">October 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3403">https://www.rfc-editor.org/rfc/rfc3403</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NTS">[NTS]</dt>
        <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8915">https://www.rfc-editor.org/rfc/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Public-Suffix">[Public-Suffix]</dt>
        <dd>
<span class="refTitle">"Public Suffix List"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://publicsuffix.org">https://publicsuffix.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC">[QUIC]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9001">https://www.rfc-editor.org/rfc/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SECTERMS">[SECTERMS]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIP">[SIP]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Camarillo, G.</span>, <span class="refAuthor">Johnston, A.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Sparks, R.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time datetime="2002-06" class="refDate">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3261">https://www.rfc-editor.org/rfc/rfc3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIP-CERTS">[SIP-CERTS]</dt>
        <dd>
<span class="refAuthor">Gurbani, V.</span>, <span class="refAuthor">Lawrence, S.</span>, and <span class="refAuthor">A. Jeffrey</span>, <span class="refTitle">"Domain Certificates in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5922</span>, <span class="seriesInfo">DOI 10.17487/RFC5922</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5922">https://www.rfc-editor.org/rfc/rfc5922</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIP-SIPS">[SIP-SIPS]</dt>
        <dd>
<span class="refAuthor">Audet, F.</span>, <span class="refTitle">"The Use of the SIPS URI Scheme in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5630</span>, <span class="seriesInfo">DOI 10.17487/RFC5630</span>, <time datetime="2009-10" class="refDate">October 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5630">https://www.rfc-editor.org/rfc/rfc5630</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="US-ASCII">[US-ASCII]</dt>
        <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Coded Character Set - 7-bit American Standard Code for Information Interchange"</span>, <span class="seriesInfo">ANSI X3.4</span>, <time datetime="1986" class="refDate">1986</time>. </dd>
<dd class="break"></dd>
<dt id="UTS-39">[UTS-39]</dt>
        <dd>
<span class="refAuthor">Davis, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"Unicode Security Mechanisms"</span>, <span>n.d.</span>, <span>&lt;<a href="https://unicode.org/reports/tr39">https://unicode.org/reports/tr39</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VERIFY">[VERIFY]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6125">https://www.rfc-editor.org/rfc/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WSC-UI">[WSC-UI]</dt>
        <dd>
<span class="refAuthor">Saldhana, A.</span> and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"Web Security Context: User Interface Guidelines"</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.w3.org/TR/2010/REC-wsc-ui-20100812/">https://www.w3.org/TR/2010/REC-wsc-ui-20100812/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XMPP">[XMPP]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span>, <span class="refTitle">"Extensible Messaging and Presence Protocol (XMPP): Core"</span>, <span class="seriesInfo">RFC 6120</span>, <span class="seriesInfo">DOI 10.17487/RFC6120</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6120">https://www.rfc-editor.org/rfc/rfc6120</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="changes">
<section id="appendix-A">
      <h2 id="name-changes-from-rfc-6125">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-changes-from-rfc-6125" class="section-name selfRef">Changes from RFC 6125</a>
      </h2>
<p id="appendix-A-1">This document revises and obsoletes <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span> based
on the decade of experience and changes since it was published.
The major changes, in no particular order, include:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">The only legal place for a certificate wildcard is as the complete left-most
component in a domain name.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">The server identity can only be expressed in the subjectAltNames
extension; it is no longer valid to use the commonName RDN,
known as <code>CN-ID</code> in <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span>.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">Detailed discussion of pinning (configuring use of a certificate that
doesn't match the criteria in this document) has been removed and replaced
with two paragraphs in <a href="#outcome" class="xref">Section 6.5</a>.<a href="#appendix-A-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.4">The sections detailing different target audiences and which sections
to read (first) have been removed.<a href="#appendix-A-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.5">References to the X.500 directory, the survey of prior art, and the
sample text in Appendix A have been removed.<a href="#appendix-A-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.6">All references have been updated to the current latest version.<a href="#appendix-A-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.7">The TLS SNI extension is no longer new, it is commonplace.<a href="#appendix-A-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.8">Additional text on multiple identifiers, and their security considerations,
has been added.<a href="#appendix-A-2.8" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">We gratefully acknowledge everyone who contributed to the previous
version of this document, <span>[<a href="#VERIFY" class="xref">VERIFY</a>]</span>.
Thanks also to Carsten Bormann for converting the previous document
to Markdown so that we could more easily use Martin Thomson's <code>i-d-template</code>
software.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">In addition to discussion on the mailing list, the following people
contributed significant changes:
Viktor Dukhovni,
Jim Fenton,
Olle Johansson,
and
Ryan Sleevi.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter Saint-Andre</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stpeter@stpeter.im" class="email">stpeter@stpeter.im</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rich Salz</span></div>
<div dir="auto" class="left"><span class="org">Akamai Technologies</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rsalz@akamai.com" class="email">rsalz@akamai.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
